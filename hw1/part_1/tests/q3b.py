OK_FORMAT = True

test = {'name': 'q3b', 'points': 2, 'suites': [{'cases': [{'code': '>>> columns = [\'image\', \'label\', \'predicted_label\', \'correct\', \'probs\', \'confidence\']\n>>> assert all((col in train_df.columns for col in columns)), f\'train_df missing columns: {set(columns) - set(train_df.columns)}\'\n>>> assert all((col in test_df.columns for col in columns)), f\'test_df missing columns: {set(columns) - set(test_df.columns)}\'\n>>> first = train_df.iloc[0]\n>>> assert type(first[\'image\']).__name__ == \'ndarray\' and getattr(first[\'image\'], \'shape\', None) == (784,), f"image: {type(first[\'image\'])}, shape: {getattr(first[\'image\'], \'shape\', None)}"\n>>> assert isinstance(first[\'label\'], str), f"label: {type(first[\'label\'])}"\n>>> assert isinstance(first[\'predicted_label\'], str), f"predicted_label: {type(first[\'predicted_label\'])}"\n>>> assert type(first[\'correct\']).__name__ in [\'bool\', \'bool_\', \'bool8\', \'bool_\'], f"correct: {type(first[\'correct\'])}"\n>>> assert type(first[\'probs\']).__name__ == \'list\', f"probs: {type(first[\'probs\'])}"\n>>> assert type(first[\'confidence\']).__name__ in [\'float64\', \'float\'], f"confidence: {type(first[\'confidence\'])}"\n>>> assert all((isinstance(p, list) and len(p) == 10 for p in train_df[\'probs\'])), "\'probs\' in train_df not correct shape (should be length 10)"\n>>> assert all((isinstance(p, list) and len(p) == 10 for p in test_df[\'probs\'])), "\'probs\' in test_df not correct shape (should be length 10)"\n>>> assert all((abs(conf - max(probs)) < 1e-06 for conf, probs in zip(train_df[\'confidence\'], train_df[\'probs\']))), "\'confidence\' in train_df not max of \'probs\'"\n>>> assert all((abs(conf - max(probs)) < 1e-06 for conf, probs in zip(test_df[\'confidence\'], test_df[\'probs\']))), "\'confidence\' in test_df not max of \'probs\'"\n', 'hidden': False, 'locked': False, 'points': 1}], 'scored': True, 'setup': '', 'teardown': '', 'type': 'doctest'}]}